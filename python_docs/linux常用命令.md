# Linux 常用命令

## 一、查找包含指定字符串的文件【grep 、find】

### 1.1 使用grep命令

grep 是 Linux 中强大的文本搜索工具，支持递归搜索文件内容。

在当前目录及其子目录中查找包含特定字符串的文件： *grep -rn "字符串" ./* -r：递归搜索子目录。 -n：显示匹配行的行号。

- 如果需要忽略大小写：

```bash
grep -rni "字符串" ./
```

- 仅显示匹配的文件名：

```bash
grep -rl "字符串" ./
```

### 1.2 使用find 和 xargs 命令

结合 *find* 和 *xargs* 可以实现更灵活的搜索。

- 在指定目录中查找所有文件并搜索内容：

```bash
find ./ -type f | xargs grep "字符串"
```

- 仅显示包含字符串的文件名：

```bash
find ./ -type f | xargs grep -l "字符串"
```

- 如果需要忽略大小写：

```bash
find ./ -type f | xargs grep -ri "字符串"
```

### 1.3 知道文件类型时查找

如果知道目标文件的类型（如 *.txt* 文件），可以进一步优化搜索范围。

- 查找特定类型文件并搜索内容：

```bash
find ./ -type f -name "*.txt" | xargs grep "字符串"
```

- 忽略大小写并仅显示文件名：

```bash
find ./ -type f -name "*.txt" | xargs grep -li "字符串"
```

## 二、系统重新分配内存

### 2.1 drop_chches

```bash
/proc/sys/vm/drop_chches 
```

0：0是系统默认值，默认情况下表示不释放内存，由操作系统自动管理　

1：释放页缓存　]

2：释放dentries和inodes　

3：释放所有缓存

那么下面举个例子，比如这里只释放页缓存，首先使用 free -h 查看当前内存剩余

```bash
free -m
```

![image-20250807140544807](./images/image-20250807140544807.png)

当前内存剩余570M左右，另外buff/cache是1.3G，根据上面说的现在真正的剩余内存应该是1.8G左右，

首先写缓存到文件系统：

```bash
sync
```

然后执行下面命令释放内存(页缓存buff/cache)：

```bash
echo 1 > /proc/sys/vm/drop_caches
```

执行完之后，再次查看内存剩余：

![image-20250807140705726](./images/image-20250807140705726.png)

会发现内存被释放了，可用内存确实变为1.8G左右

到这里内存就释放完了，现在drop_caches中的值为1，如果现在想让操作系统重新分配内存，那么设置drop_caches的值为0即可：

```bash
echo 0 > /proc/sys/vm/drop_caches
```

## 三、vi  vim

要在vi中进行搜索，首先需要确保处于命令模式（普通模式）。这可以通过按下*Esc*键来实现。一旦进入命令模式，可以使用以下步骤进行搜索：

1. 输入*/*字符，进入搜索模式。

1. 紧接着输入要搜索的字符串，例如*/your_search_term*。
2. 按下*Enter*键执行搜索。

**高级搜索技巧**

除了基本搜索外，vi还支持使用正则表达式进行更复杂的搜索模式匹配。例如，如果你想**搜索所有以字母"a"开头的单词**，可以使用以下命令：

```bash
/\va\w*
```

在这里，*\v*表示启用非转义的非规范模式，而*\w**表示匹配零个或多个单词字符。

**搜索高亮显示**

为了更容易地识别搜索结果，vi允许用户设置搜索结果的高亮显示。可以通过在命令模式下输入以下命令来启用此功能：

```bash
:set hlsearch
```

这样，所有搜索匹配的内容将在文本中高亮显示。

**全词匹配**

有时候，我们可能只想搜索作为独立单词出现的字符串。为了实现全词匹配，可以在搜索关键字前后添加*\b*。例如，搜索单词"test"，可以使用：

```bash
/\btest\b
```

**搜索和替换**

vi还提供了搜索和替换的功能。例如，要将文件中所有的"old"替换为"new"，可以使用以下命令：

```bash
:%s/old/new/g
```





